(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{25:function(e,t,n){e.exports={viewport:"PdfViewport_viewport__3V6dn",page:"PdfViewport_page__1uGEO",overlay:"PdfViewport_overlay__NZQ23",item:"PdfViewport_item__344HK"}},31:function(e,t,n){e.exports={toolbar:"Toolbar_toolbar__1pnoi",scale:"Toolbar_scale__iCcp-",text:"Toolbar_text__1k5cZ"}},32:function(e,t,n){e.exports={screenViewport:"PdfEditor_screenViewport__2ZHEP",editorArea:"PdfEditor_editorArea__3RcQj",pdfViewportArea:"PdfEditor_pdfViewportArea__3dnYL"}},34:function(e,t,n){e.exports={dropzone:"PdfLoader_dropzone__1u5la",inner:"PdfLoader_inner__3auJD"}},65:function(e,t,n){e.exports=n(81)},70:function(e,t,n){},71:function(e,t,n){},81:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),o=n(44),c=n.n(o),i=(n(70),n(71),n(8)),s=Object(a.createContext)({data:null,setData:function(){},isFileLoaded:function(){}}),u=function(e){var t=e.children,n=Object(a.useState)(null),o=Object(i.a)(n,2),c=o[0],u=o[1];console.log("[file-context] file data:",c);return r.a.createElement(s.Provider,{value:{data:c,setData:u,isFileLoaded:function(){return null!==c}}},t)},l=Object(a.createContext)({scale:1,setScale:function(){},resetScale:function(){}}),d=function(e){var t=e.children,n=Object(a.useState)(1),o=Object(i.a)(n,2),c=o[0],s=o[1];return r.a.createElement(l.Provider,{value:{scale:c,setScale:s,resetScale:function(){return s(1)}}},t)},p=Object(a.createContext)({counter:2,resetCounter:function(){},incrementCounter:function(){}}),f=function(e){var t=e.children,n=Object(a.useState)(2),o=Object(i.a)(n,2),c=o[0],s=o[1];return r.a.createElement(p.Provider,{value:{counter:c,resetCounter:function(){return s(2)},incrementCounter:function(){return s(function(e){return e+1})}}},t)},m=n(7),b=n.n(m),v=n(17),h=n(45),O=n(30),j=n(62),g=n(64);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(n,!0).forEach(function(t){Object(j.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var w=[],x=Object(a.createContext)({modList:w,resetModList:function(){},addMod:function(){}}),k=function(e){var t=e.children,n=Object(a.useState)(w),o=Object(i.a)(n,2),c=o[0],s=o[1],u=Object(a.useState)(0),l=Object(i.a)(u,2),d=l[0],p=l[1];return r.a.createElement(x.Provider,{value:{modList:c,resetModList:function(){s(w),p(0)},addMod:function(e){return p(function(e){return e+1}),s(function(t){return[].concat(Object(g.a)(t),[E({},e,{id:d})])})}}},t)};function C(){return(C=Object(v.a)(b.a.mark(function e(t,n){var a,r,o,c,s,u,l,d,p;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.PDFDocument.load(t);case 2:return a=e.sent,e.next=5,a.embedFont(O.StandardFonts.Helvetica);case 5:return r=e.sent,o=a.getPages(),c=Object(i.a)(o,1),s=c[0],u=s.getSize(),l=u.height,n.forEach(function(e){s.drawText(e.content,{x:e.position.x,y:l-(e.position.y+e.size),size:e.size,font:r,color:Object(O.rgb)(1,0,0)})}),e.next=11,a.save();case 11:d=e.sent,p=new Blob([d],{type:"application/pdf"}),console.log("request to download file accepted",p),Object(h.saveAs)(p,"output.pdf");case 15:case"end":return e.stop()}},e)}))).apply(this,arguments)}var _=function(e){var t=e.children,n=Object(a.useContext)(s),r=n.data,o=n.isFileLoaded,c=Object(a.useContext)(l),i=c.scale,u=c.setScale,d=Object(a.useContext)(p).counter,f=Object(a.useContext)(x).modList;return t({disabled:!1===o(),scale:i,onZoomChange:function(e){return u(function(t){return t+e})},counter:d,onDownload:function(){return function(e,t){return C.apply(this,arguments)}(r,f)}})},D=n(31),P=n.n(D);var N=function(e){var t=e.disabled,n=e.scale,a=e.counter,o=e.onZoomChange,c=e.onDownload,i=e.onLoad,s=t?null:r.a.createElement("div",{className:P.a.text},"Place next running label: ","{".concat(a,"}"));return r.a.createElement("div",{className:P.a.toolbar},r.a.createElement("div",{className:P.a.scale},r.a.createElement("button",{disabled:t,onClick:function(){return o(.1)}},"+"),r.a.createElement("button",{disabled:t,onClick:function(){return o(-.1)}},"-"),r.a.createElement("input",{type:"text",disabled:!0,value:"".concat((100*n).toFixed(0),"%")})),r.a.createElement("button",{disabled:t,onClick:i},"Load"),r.a.createElement("button",{disabled:t,onClick:c},"Download"),s)};var L=function(e){var t=e.children,n=Object(a.useState)(!0),r=Object(i.a)(n,2),o=r[0],c=r[1],u=Object(a.useContext)(s),d=u.isFileLoaded,f=u.setData,m=Object(a.useContext)(l).resetScale,b=Object(a.useContext)(p).resetCounter,v=Object(a.useContext)(x).resetModList;return t({showDialog:o,openDialog:function(){return c(!0)},closeDialog:function(){return c(!1)},onLoad:function(e){c(!1),f(e),m(),b(),v()},isAtReload:function(){return d()&&o}})},S=n(12),F=n(13),z=n(15),A=n(14),M=n(16),V=n(63),R=n.n(V),B=n(34),Z=n.n(B),I=function(e){function t(){var e,n;Object(S.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(z.a)(this,(e=Object(A.a)(t)).call.apply(e,[this].concat(r)))).onFilesChange=function(){var e=Object(v.a)(b.a.mark(function e(t){var a,r;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("got request to load files:",t),a=t[0],e.next=4,a.arrayBuffer();case 4:r=e.sent,console.log("data:",r),n.props.onLoad(r);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.onFilesError=function(e,t){console.warn("error loading files ".concat(t,". error:"),e)},n}return Object(M.a)(t,e),Object(F.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:Z.a.dropzone},r.a.createElement(R.a,{className:Z.a.inner,onChange:this.onFilesChange,onError:this.onFilesError,accepts:[".pdf"],clickable:!0,maxFiles:1},"Drop a file here or click to upload"))}}]),t}(a.Component),K=n(29),T=n(28);function U(e){return T.a.getDocument(e).promise}var W=function(e){function t(e){var n;return Object(S.a)(this,t),(n=Object(z.a)(this,Object(A.a)(t).call(this,e))).state={docObj:null,data:e.data},n}return Object(M.a)(t,e),Object(F.a)(t,[{key:"componentDidMount",value:function(){var e=Object(v.a)(b.a.mark(function e(){var t;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U(this.props.data);case 2:t=e.sent,this.setState({docObj:t});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(v.a)(b.a.mark(function e(t,n){var a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.data===t.data){e.next=6;break}return console.log("[PdfDoc] updating doc object"),e.next=4,U(this.props.data);case 4:a=e.sent,this.setState({docObj:a,data:this.props.data});case 6:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.children;return null!==this.state.docObj?e(this.state.docObj):null}}]),t}(a.Component);function H(e,t){return e.getPage(t)}var J=function(e){function t(e){var n;return Object(S.a)(this,t),(n=Object(z.a)(this,Object(A.a)(t).call(this,e))).state={pageObj:null},n}return Object(M.a)(t,e),Object(F.a)(t,[{key:"componentDidMount",value:function(){var e=Object(v.a)(b.a.mark(function e(){var t,n,a,r;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.document,a=t.pageNum,e.next=3,H(n,a);case 3:r=e.sent,this.setState({pageObj:r});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(v.a)(b.a.mark(function e(t,n){var a,r,o,c;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.props,r=a.document,o=a.pageNum,r===t.document&&o===t.pageNum){e.next=6;break}return e.next=4,H(r,o);case 4:c=e.sent,this.setState({pageObj:c});case 6:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.children;return null!==this.state.pageObj?e(this.state.pageObj):null}}]),t}(a.Component);function q(e,t,n){var a=t.getViewport({scale:n});e.width=a.width,e.height=a.height,t.render({canvasContext:e.getContext("2d"),viewport:a})}var G=function(e){function t(e){var n;return Object(S.a)(this,t),(n=Object(z.a)(this,Object(A.a)(t).call(this,e))).getMousePos=function(e,t){var a=n.canvasRef.current.getBoundingClientRect();return{x:e-a.left,y:t-a.top}},n.canvasRef=r.a.createRef(),n}return Object(M.a)(t,e),Object(F.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.page,n=e.scale;q(this.canvasRef.current,t,n)}},{key:"componentDidUpdate",value:function(){var e=this.props,t=e.page,n=e.scale;q(this.canvasRef.current,t,n)}},{key:"render",value:function(){var e=this,t=this.props,n=(t.page,t.scale,t.onClick),a=Object(K.a)(t,["page","scale","onClick"]);return n instanceof Function&&(a.onClick=function(t){return e.props.onClick(t,e.getMousePos(t.clientX,t.clientY))}),a.style=a.style||{},a.style.cursor="crosshair",r.a.createElement("canvas",Object.assign({ref:this.canvasRef},a))}}]),t}(a.Component);var Q=r.a.memo(function(e){var t=e.position,n=e.size,a=e.content,o=e.scale,c=e.className;return r.a.createElement("div",{className:c,style:{left:"".concat(t.x*o,"px"),top:"".concat(t.y*o,"px"),fontSize:"".concat(n*o,"px")}},a)}),Y=n(25),X=n.n(Y);var $=function(e){var t=e.data,n=e.pageNum,a=e.scale,o=e.overlayItems,c=e.className,i=e.style,s=Object(K.a)(e,["data","pageNum","scale","overlayItems","className","style"]);return r.a.createElement("div",{className:"".concat(c," ").concat(X.a.viewport),style:i},r.a.createElement("div",{className:X.a.page},null!==t?r.a.createElement(W,{data:t},function(e){return r.a.createElement(J,{document:e,pageNum:n},function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:X.a.overlay},o.map(function(e){return r.a.createElement(Q,{key:e.id,className:X.a.item,position:e.position,size:e.size,content:e.content,scale:a})})),r.a.createElement(G,Object.assign({page:e,scale:a},s)))})}):null))};var ee=function(e){var t=e.children,n=Object(a.useContext)(s),r=n.data,o=(n.setData,Object(a.useContext)(l).scale),c=Object(a.useContext)(p),i=c.counter,u=c.incrementCounter,d=Object(a.useContext)(x),f=d.modList,m=d.addMod;return t({data:r,pageNum:1,scale:o,overlayItems:f,onClick:function(e,t){return function(e,t,n,a,r){a({position:{x:n.x/e,y:n.y/e},size:20,content:"{".concat(t,"}")}),r()}(o,i,t,m,u)}})},te=function(e){function t(){var e,n;Object(S.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(z.a)(this,(e=Object(A.a)(t)).call.apply(e,[this].concat(r)))).onKeyup=function(e){["Escape","Esc"].includes(e.key)&&n.props.onClick()},n}return Object(M.a)(t,e),Object(F.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("keyup",this.onKeyup,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keyup",this.onKeyup,!1)}},{key:"render",value:function(){return null}}]),t}(a.Component),ne=n(32),ae=n.n(ne);var re=function(){return console.log("[PdfEditor] render"),r.a.createElement("div",{className:ae.a.screenViewport},r.a.createElement("h1",null,"PDF Editor"),r.a.createElement(d,null,r.a.createElement(f,null,r.a.createElement(k,null,r.a.createElement("div",{className:ae.a.editorArea},r.a.createElement(L,null,function(e){return r.a.createElement(r.a.Fragment,null,e.isAtReload()?r.a.createElement(te,{onClick:e.closeDialog}):null,r.a.createElement(_,null,function(t){return r.a.createElement(N,Object.assign({onLoad:e.openDialog},t))}),r.a.createElement("div",{className:ae.a.pdfViewportArea},e.showDialog?r.a.createElement(I,{onLoad:e.onLoad}):null,r.a.createElement(ee,null,function(e){return r.a.createElement($,e)})))}))))))};var oe=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(u,null,r.a.createElement(re,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));T.a.GlobalWorkerOptions.workerSrc="https://cdn.jsdelivr.net/npm/pdfjs-dist@2.1.266/build/pdf.worker.min.js",c.a.render(r.a.createElement(oe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[65,1,2]]]);
//# sourceMappingURL=main.88e82abb.chunk.js.map