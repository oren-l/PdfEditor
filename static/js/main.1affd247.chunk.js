(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{25:function(e,t,n){e.exports={viewport:"PdfViewport_viewport__3V6dn",page:"PdfViewport_page__1uGEO",overlay:"PdfViewport_overlay__NZQ23",item:"PdfViewport_item__344HK"}},30:function(e,t,n){e.exports={toolbar:"Toolbar_toolbar__1pnoi",scale:"Toolbar_scale__iCcp-",text:"Toolbar_text__1k5cZ"}},31:function(e,t,n){e.exports={screenViewport:"PdfEditor_screenViewport__2ZHEP",editorArea:"PdfEditor_editorArea__3RcQj",pdfViewportArea:"PdfEditor_pdfViewportArea__3dnYL"}},35:function(e,t,n){e.exports={dropzone:"PdfLoader_dropzone__1u5la",inner:"PdfLoader_inner__3auJD"}},67:function(e,t,n){e.exports=n(86)},72:function(e,t,n){},73:function(e,t,n){},86:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n.n(r),o=n(44),c=n.n(o),i=(n(72),n(73),n(9)),u=Object(r.createContext)({data:null,setData:function(){},isFileLoaded:function(){}}),s=function(e){var t=e.children,n=Object(r.useState)(null),o=Object(i.a)(n,2),c=o[0],s=o[1];console.log("[file-context] file data:",c);return a.a.createElement(u.Provider,{value:{data:c,setData:s,isFileLoaded:function(){return null!==c}}},t)},l=Object(r.createContext)({scale:1,setScale:function(){},resetScale:function(){}}),d=function(e){var t=e.children,n=Object(r.useState)(1),o=Object(i.a)(n,2),c=o[0],u=o[1];return a.a.createElement(l.Provider,{value:{scale:c,setScale:u,resetScale:function(){return u(1)}}},t)},p=Object(r.createContext)({counter:2,resetCounter:function(){},incrementCounter:function(){},decrementCounter:function(){}}),f=function(e){var t=e.children,n=Object(r.useState)(2),o=Object(i.a)(n,2),c=o[0],u=o[1];return a.a.createElement(p.Provider,{value:{counter:c,resetCounter:function(){return u(2)},incrementCounter:function(){return u(function(e){return e+1})},decrementCounter:function(){return u(function(e){return e-1})}}},t)},m=n(8),v=n.n(m),b=n(17),O=n(45),h=n(34),j=n(62),g=n(28),y=n(65);function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(n,!0).forEach(function(t){Object(g.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var x=[],C=Object(r.createContext)({modList:x,resetModList:function(){},addMod:function(){},changeMod:function(e,t){},removeMod:function(e){}}),k=function(e){var t=e.children,n=Object(r.useState)(x),o=Object(i.a)(n,2),c=o[0],u=o[1],s=Object(r.useState)(0),l=Object(i.a)(s,2),d=l[0],p=l[1];return a.a.createElement(C.Provider,{value:{modList:c,resetModList:function(){u(x),p(0)},addMod:function(e){return p(function(e){return e+1}),u(function(t){return[].concat(Object(y.a)(t),[w({},e,{id:d})])})},changeMod:function(e,t){var n=c.map(function(n){return n.id!==e?n:t(n)});u(n)},removeMod:function(e){var t=c.filter(function(t){return t.id!==e}).map(function(t){return t.id<e?t:w({},t,{value:t.value-1})});u(t)}}},t)};function P(){return(P=Object(b.a)(v.a.mark(function e(t,n){var r,a,o,c,u,s,l,d,p,f,m;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.PDFDocument.load(t);case 2:return r=e.sent,a="".concat("/PdfEditor","/fonts/Roboto/Roboto-Regular.ttf"),r.registerFontkit(j.a),e.next=7,fetch(a).then(function(e){return e.arrayBuffer()});case 7:return o=e.sent,console.log("font loaded: ",o),e.next=11,r.embedFont(o);case 11:return c=e.sent,u=r.getPages(),s=Object(i.a)(u,1),l=s[0],d=l.getSize(),p=d.height,n.forEach(function(e){l.drawText(e.template(e.value),{x:e.position.x,y:p-(e.position.y+e.size),size:e.size,font:c,color:Object(h.rgb)(0,0,1)})}),e.next=17,r.save();case 17:f=e.sent,m=new Blob([f],{type:"application/pdf"}),console.log("request to download file accepted",m),Object(O.saveAs)(m,"output.pdf");case 21:case"end":return e.stop()}},e)}))).apply(this,arguments)}var D=function(e){var t=e.children,n=Object(r.useContext)(u),a=n.data,o=n.isFileLoaded,c=Object(r.useContext)(l),i=c.scale,s=c.setScale,d=Object(r.useContext)(p).counter,f=Object(r.useContext)(C).modList;return t({disabled:!1===o(),scale:i,onZoomChange:function(e){return s(function(t){return t+e})},counter:d,onDownload:function(){return function(e,t){return P.apply(this,arguments)}(a,f)}})},_=n(30),S=n.n(_);var N=function(e){var t=e.disabled,n=e.scale,r=e.counter,o=e.onZoomChange,c=e.onDownload,i=e.onLoad,u=t?null:a.a.createElement("div",{className:S.a.text},"Place next running label: ","{".concat(r,"}"));return a.a.createElement("div",{className:S.a.toolbar},a.a.createElement("div",{className:S.a.scale},a.a.createElement("button",{disabled:t,onClick:function(){return o(.1)}},"+"),a.a.createElement("button",{disabled:t,onClick:function(){return o(-.1)}},"-"),a.a.createElement("input",{type:"text",disabled:!0,value:"".concat((100*n).toFixed(0),"%")})),a.a.createElement("button",{disabled:t,onClick:i},"Load"),a.a.createElement("button",{disabled:t,onClick:c},"Download"),u)};var L=function(e){var t=e.children,n=Object(r.useState)(!0),a=Object(i.a)(n,2),o=a[0],c=a[1],s=Object(r.useContext)(u),d=s.isFileLoaded,f=s.setData,m=Object(r.useContext)(l).resetScale,v=Object(r.useContext)(p).resetCounter,b=Object(r.useContext)(C).resetModList;return t({showDialog:o,openDialog:function(){return c(!0)},closeDialog:function(){return c(!1)},onLoad:function(e){c(!1),f(e),m(),v(),b()},isAtReload:function(){return d()&&o}})},M=n(12),z=n(13),F=n(15),R=n(14),A=n(16),V=n(63),I=n.n(V),B=n(35),K=n.n(B),T=function(e){function t(){var e,n;Object(M.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(R.a)(t)).call.apply(e,[this].concat(a)))).onFilesChange=function(){var e=Object(b.a)(v.a.mark(function e(t){var r,a;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("got request to load files:",t),r=t[0],e.next=4,r.arrayBuffer();case 4:a=e.sent,console.log("data:",a),n.props.onLoad(a);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.onFilesError=function(e,t){console.warn("error loading files ".concat(t,". error:"),e)},n}return Object(A.a)(t,e),Object(z.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:K.a.dropzone},a.a.createElement(I.a,{className:K.a.inner,onChange:this.onFilesChange,onError:this.onFilesError,accepts:[".pdf"],clickable:!0,maxFiles:1},"Drop a file here or click to upload"))}}]),t}(r.Component),Z=n(29);function U(e){return Z.a.getDocument(e).promise}var W=function(e){function t(e){var n;return Object(M.a)(this,t),(n=Object(F.a)(this,Object(R.a)(t).call(this,e))).state={docObj:null,data:e.data},n}return Object(A.a)(t,e),Object(z.a)(t,[{key:"componentDidMount",value:function(){var e=Object(b.a)(v.a.mark(function e(){var t;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U(this.props.data);case 2:t=e.sent,this.setState({docObj:t});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(b.a)(v.a.mark(function e(t,n){var r;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.data===t.data){e.next=6;break}return console.log("[PdfDoc] updating doc object"),e.next=4,U(this.props.data);case 4:r=e.sent,this.setState({docObj:r,data:this.props.data});case 6:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.children;return null!==this.state.docObj?e(this.state.docObj):null}}]),t}(r.Component);function J(e,t){return e.getPage(t)}var Y=function(e){function t(e){var n;return Object(M.a)(this,t),(n=Object(F.a)(this,Object(R.a)(t).call(this,e))).state={pageObj:null},n}return Object(A.a)(t,e),Object(z.a)(t,[{key:"componentDidMount",value:function(){var e=Object(b.a)(v.a.mark(function e(){var t,n,r,a;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.document,r=t.pageNum,e.next=3,J(n,r);case 3:a=e.sent,this.setState({pageObj:a});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(b.a)(v.a.mark(function e(t,n){var r,a,o,c;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.props,a=r.document,o=r.pageNum,a===t.document&&o===t.pageNum){e.next=6;break}return e.next=4,J(a,o);case 4:c=e.sent,this.setState({pageObj:c});case 6:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.children;return null!==this.state.pageObj?e(this.state.pageObj):null}}]),t}(r.Component);function q(e,t,n){var r=t.getViewport({scale:n});e.width=r.width,e.height=r.height,t.render({canvasContext:e.getContext("2d"),viewport:r})}var G=function(e){function t(e){var n;return Object(M.a)(this,t),(n=Object(F.a)(this,Object(R.a)(t).call(this,e))).getMousePos=function(e,t){var r=n.canvasRef.current.getBoundingClientRect();return{x:e-r.left,y:t-r.top}},n.canvasRef=a.a.createRef(),n}return Object(A.a)(t,e),Object(z.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.page,n=e.scale;q(this.canvasRef.current,t,n)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.page,r=t.scale;n===e.page&&r===e.scale||q(this.canvasRef.current,n,r)}},{key:"render",value:function(){var e=this,t=this.props.onClick;return a.a.createElement("canvas",{ref:this.canvasRef,onClick:function(n){return t(n,e.getMousePos(n.clientX,n.clientY))},style:{cursor:"crosshair"}})}}]),t}(r.Component),H=n(64),Q=n.n(H),X=n(66);var $=a.a.memo(function(e){var t=e.position,n=e.size,r=e.value,o=e.scale,c=e.template,i=e.className,u=e.isSelected,s=Object(X.a)(e,["position","size","value","scale","template","className","isSelected"]);return a.a.createElement("div",Object.assign({className:i,style:{left:"".concat(t.x*o,"px"),top:"".concat(t.y*o,"px"),fontSize:"".concat(n*o,"px"),outline:u?"1px solid red":"none",cursor:u?"grab":null},draggable:u,title:u?"Press <Delete> to remove this":null},s),c(r))}),ee=n(25),te=n.n(ee);var ne=function(e){var t=e.items,n=e.scale,o=e.onItemMove,c=e.onItemDelete,u=Object(r.useRef)(null),s=Object(r.useState)(null),l=Object(i.a)(s,2),d=l[0],p=l[1];return a.a.createElement("div",{ref:u,className:te.a.overlay,style:{position:null!==d?"absolute":null},onClick:function(){p(null)}},a.a.createElement(Q.a,{handleKeys:["delete"],handleEventType:"keyup",onKeyEvent:function(){null!==d&&(c(d),p(null))}}),t.map(function(e){return a.a.createElement($,{key:e.id,className:te.a.item,position:e.position,size:e.size,value:e.value,scale:n,template:e.template,onDragEnd:function(t){return o(t,function(e,t){var n=e.getBoundingClientRect(),r=n.left,a=n.top;return{x:t.clientX-r,y:t.clientY-a}}(u.current,t),e.id)},isSelected:e.id===d,onClick:function(t){p(e.id),t.stopPropagation()}})}))};var re=function(e){var t=e.data,n=e.pageNum,r=e.scale,o=e.overlayItems,c=e.className,i=void 0===c?"":c,u=e.style,s=e.onClick,l=e.onItemMove,d=e.onItemDelete;return a.a.createElement("div",{className:"".concat(i," ").concat(te.a.viewport),style:u},a.a.createElement("div",{className:te.a.page},null!==t?a.a.createElement(W,{data:t},function(e){return a.a.createElement(Y,{document:e,pageNum:n},function(e){return a.a.createElement(a.a.Fragment,null,a.a.createElement(ne,{items:o,scale:r,onItemMove:l,onItemDelete:d}),a.a.createElement(G,{page:e,scale:r,onClick:s}))})}):null))};function ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var oe=function(e){var t=e.children,n=Object(r.useContext)(u).data,a=Object(r.useContext)(l).scale,o=Object(r.useContext)(p),c=o.counter,i=o.incrementCounter,s=o.decrementCounter,d=Object(r.useContext)(C),f=d.modList,m=d.addMod,v=d.changeMod,b=d.removeMod;return t({data:n,pageNum:1,scale:a,overlayItems:f,onClick:function(e,t){return function(e,t,n,r,a){r({position:{x:n.x/e-6,y:n.y/e-6},size:12,value:t,template:function(e){return"(".concat(e,")")}}),a()}(a,c,t,m,i)},onItemMove:function(e,t,n){v(n,function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ae(n,!0).forEach(function(t){Object(g.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ae(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e,{position:{x:t.x/a-e.size/2,y:t.y/a-e.size/2}})})},onItemDelete:function(e){b(e),s()}})},ce=function(e){function t(){var e,n;Object(M.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(F.a)(this,(e=Object(R.a)(t)).call.apply(e,[this].concat(a)))).onKeyup=function(e){["Escape","Esc"].includes(e.key)&&n.props.onClick()},n}return Object(A.a)(t,e),Object(z.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("keyup",this.onKeyup,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keyup",this.onKeyup,!1)}},{key:"render",value:function(){return null}}]),t}(r.Component),ie=n(31),ue=n.n(ie);var se=function(){return console.log("[PdfEditor] render"),a.a.createElement("div",{className:ue.a.screenViewport},a.a.createElement(d,null,a.a.createElement(f,null,a.a.createElement(k,null,a.a.createElement("div",{className:ue.a.editorArea},a.a.createElement(L,null,function(e){return a.a.createElement(a.a.Fragment,null,e.isAtReload()?a.a.createElement(ce,{onClick:e.closeDialog}):null,a.a.createElement(D,null,function(t){return a.a.createElement(N,Object.assign({onLoad:e.openDialog},t))}),a.a.createElement("div",{className:ue.a.pdfViewportArea},e.showDialog?a.a.createElement(T,{onLoad:e.onLoad}):null,a.a.createElement(oe,null,function(e){return a.a.createElement(re,e)})))}))))))};var le=function(){return a.a.createElement("div",{className:"App"},a.a.createElement(s,null,a.a.createElement(se,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));Z.a.GlobalWorkerOptions.workerSrc="https://cdn.jsdelivr.net/npm/pdfjs-dist@2.1.266/build/pdf.worker.min.js",c.a.render(a.a.createElement(le,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[67,1,2]]]);
//# sourceMappingURL=main.1affd247.chunk.js.map