{"version":3,"sources":["components/Toolbar/Toolbar.module.css","components/PdfRenderer/Overlay/Overlay.module.css","components/PdfEditor/PdfEditor.module.css","components/PdfLoader/PdfLoader.module.css","components/PdfRenderer/PdfViewport.module.css","context/file-context.js","context/viewport-context.js","context/counter-context.js","context/modification-context.js","containers/ToobarController/ToobarController.js","components/Toolbar/Toolbar.js","containers/LoadDialogController/LoadDialogController.js","components/PdfLoader/PdfLoader.js","components/PdfRenderer/PdfDoc.js","components/PdfRenderer/PdfPage.js","components/PdfRenderer/PdfCanvas.js","components/PdfRenderer/Overlay/OverlayItem.js","components/PdfRenderer/Overlay/Overlay.js","components/PdfRenderer/PdfViewport.js","containers/PdfViewportController/PdfViewportController.js","components/EscKeyHandler/EscKeyHandler.js","components/PdfEditor/PdfEditor.js","containers/App.js","serviceWorker.js","index.js"],"names":["module","exports","FileContext","createContext","data","setData","isFileLoaded","children","useState","console","log","Provider","value","ViewportContext","scale","setScale","resetScale","fontSize","setFontSize","CounterContext","counter","resetCounter","incrementCounter","decrementCounter","setCounter","initialModList","ModificationContext","modList","resetModList","addMod","changeMod","id","changeFunc","removeMod","setModList","nextId","setNextId","mod","changedModList","map","filter","getPositiveAngle","angle","translatePos","x","y","width","height","fileData","modificationList","a","PDFDocument","load","pdfDoc","fontUrl","process","registerFontkit","fontkit","fetch","then","res","arrayBuffer","fontBytes","embedFont","font","getPages","firstPage","getSize","originalAngle","getRotation","forEach","item","position","drawText","template","rotate","degrees","size","color","rgb","save","modifiedData","blob","Blob","type","saveAs","setFileData","currAngle","setRotation","ToolbarController","useContext","disabled","onZoomChange","amount","onRotate","length","window","confirm","onDownload","download","toolbar","onLoad","runningLabelText","className","styles","text","group","onClick","toFixed","title","onChange","event","input","target","isValidFormat","test","validity","valid","parseFloat","Math","round","roundByHalf","min","max","step","LoadDialogController","showDialog","setShowDialog","openDialog","closeDialog","isAtReload","PdfLoader","onFilesChange","files","file","props","onFilesError","error","warn","dropzone","inner","this","onError","accepts","clickable","maxFiles","Component","loadDocument","pdfjs","getDocument","promise","PdfDoc","state","docObj","setState","prevProps","prevState","loadPage","doc","pageNum","getPage","PdfPage","pageObj","document","renderPdfToCanvas","canvasEl","page","viewport","getViewport","render","canvasContext","getContext","PdfCanvas","getMousePos","canvasRef","current","getBoundingClientRect","left","top","React","createRef","ref","clientX","clientY","style","cursor","memo","isSelected","otherProps","selected","draggable","Overlay","items","onItemMove","onItemDelete","overlayRef","useRef","selectedItemId","setSelectedItemId","useEffect","overlay","handleKeys","handleEventType","onKeyEvent","key","onDragEnd","element","getRelativeMousePos","stopPropagation","PdfViewport","overlayItems","Fragment","PdfViewportController","addModification","placeRunningCounter","EscKeyHandler","onKeyup","includes","addEventListener","removeEventListener","PdfEditor","screenViewport","editorArea","loadDialogCtrl","toolbarCtrl","Toolbar","pdfViewportArea","viewportCtrl","App","Boolean","location","hostname","match","GlobalWorkerOptions","workerSrc","ReactDOM","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.bce750ea.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"toolbar\":\"Toolbar_toolbar__1pnoi\",\"group\":\"Toolbar_group__3Bx_F\",\"text\":\"Toolbar_text__1k5cZ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"overlay\":\"Overlay_overlay__K05mY\",\"item\":\"Overlay_item__1Uqku\",\"selected\":\"Overlay_selected__3ljIr\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"screenViewport\":\"PdfEditor_screenViewport__2ZHEP\",\"editorArea\":\"PdfEditor_editorArea__3RcQj\",\"pdfViewportArea\":\"PdfEditor_pdfViewportArea__3dnYL\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dropzone\":\"PdfLoader_dropzone__1u5la\",\"inner\":\"PdfLoader_inner__3auJD\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"viewport\":\"PdfViewport_viewport__3V6dn\",\"page\":\"PdfViewport_page__1uGEO\"};","import React, { useState, createContext } from 'react'\n\nconst NO_FILE_DATA = null\nexport const initialState = { data: NO_FILE_DATA }\nexport const FileContext = createContext({\n  data: NO_FILE_DATA,\n  setData: () => {},\n  isFileLoaded: () => {}\n})\n\nexport default ({ children }) => {\n  const [data, setData] = useState(NO_FILE_DATA)\n  console.log('[file-context] file data:', data)\n  const isFileLoaded = () => data !== NO_FILE_DATA\n\n  return (\n    <FileContext.Provider value={{ data, setData, isFileLoaded }}>\n      {children}\n    </FileContext.Provider>\n  )\n}\n","import React, { useState, createContext } from 'react'\n\nconst initialScale = 1 // = 100%\nconst initialFontSize = 12\n\nexport const ViewportContext = createContext({\n  scale: initialScale,\n  setScale: () => {},\n  resetScale: () => {},\n  fontSize: initialFontSize,\n  setFontSize: () => {}\n})\n\nexport default ({ children }) => {\n  const [scale, setScale] = useState(initialScale)\n  const [fontSize, setFontSize] = useState(initialFontSize)\n  const resetScale = () => setScale(initialScale)\n\n  return (\n    <ViewportContext.Provider\n      value={{ scale, setScale, resetScale, fontSize, setFontSize }}\n    >\n      {children}\n    </ViewportContext.Provider>\n  )\n}\n","import React, { useState, createContext } from 'react'\n\nconst initialCounter = 2\n\nexport const CounterContext = createContext({\n  counter: initialCounter,\n  resetCounter: () => {},\n  incrementCounter: () => {},\n  decrementCounter: () => {}\n})\n\nexport default ({ children }) => {\n  const [counter, setCounter] = useState(initialCounter)\n  const resetCounter = () => setCounter(initialCounter)\n  const incrementCounter = () => setCounter(counter => counter + 1)\n  const decrementCounter = () => setCounter(counter => counter - 1)\n  return (\n    <CounterContext.Provider\n      value={{ counter, resetCounter, incrementCounter, decrementCounter }}\n    >\n      {children}\n    </CounterContext.Provider>\n  )\n}\n","import React, { useState, createContext } from 'react'\n\nconst initialModList = []\nconst initialId = 0\n\nexport const ModificationContext = createContext({\n  modList: initialModList,\n  resetModList: () => {},\n  addMod: () => {},\n  changeMod: (id, changeFunc) => {},\n  removeMod: id => {}\n})\n\nexport default ({ children }) => {\n  const [modList, setModList] = useState(initialModList)\n  const [nextId, setNextId] = useState(initialId)\n  const resetModList = () => {\n    setModList(initialModList)\n    setNextId(initialId)\n  }\n\n  const addMod = mod => {\n    setNextId(id => id + 1)\n    return setModList(modList => [\n      ...modList,\n      {\n        ...mod,\n        id: nextId\n      }\n    ])\n  }\n\n  const changeMod = (id, changeFunc) => {\n    const changedModList = modList.map(mod =>\n      mod.id !== id ? mod : changeFunc(mod)\n    )\n\n    setModList(changedModList)\n  }\n\n  const removeMod = id => {\n    const changedModList = modList\n      .filter(mod => mod.id !== id)\n      .map(mod => (mod.id < id ? mod : { ...mod, value: mod.value - 1 }))\n    setModList(changedModList)\n  }\n\n  return (\n    <ModificationContext.Provider\n      value={{\n        modList,\n        resetModList,\n        addMod,\n        changeMod,\n        removeMod\n      }}\n    >\n      {children}\n    </ModificationContext.Provider>\n  )\n}\n","import { useContext } from 'react'\nimport { saveAs } from 'file-saver'\nimport { PDFDocument, rgb, degrees } from 'pdf-lib'\nimport fontkit from '@pdf-lib/fontkit'\n\nimport { FileContext } from '../../context/file-context'\nimport { ViewportContext } from '../../context/viewport-context'\nimport { CounterContext } from '../../context/counter-context'\nimport { ModificationContext } from '../../context/modification-context'\n\nconst getPositiveAngle = angle => ((angle % 360) + 360) % 360\n\nfunction translatePos(angle, x, y, width, height) {\n  switch (angle) {\n    case 0:\n      return { x, y }\n    case 90:\n      return { x: y, y: height - x }\n    case 180:\n      return { x: width - x, y: height - y }\n    case 270:\n      return { x: width - y, y: x }\n  }\n}\n\nasync function download(fileData, modificationList, fontSize) {\n  const pdfDoc = await PDFDocument.load(fileData)\n  const fontUrl = `${process.env.PUBLIC_URL}/fonts/Roboto/Roboto-Regular.ttf`\n  pdfDoc.registerFontkit(fontkit)\n  const fontBytes = await fetch(fontUrl).then(res => res.arrayBuffer())\n  console.log('font loaded: ', fontBytes)\n  const font = await pdfDoc.embedFont(fontBytes)\n  const [firstPage] = pdfDoc.getPages()\n  const { width, height } = firstPage.getSize()\n  const originalAngle = firstPage.getRotation().angle\n  const angle = getPositiveAngle(originalAngle)\n  console.log(`original: ${originalAngle} angle: ${angle}`)\n\n  modificationList.forEach(item => {\n    const position = translatePos(\n      angle,\n      item.position.x - fontSize / 2,\n      item.position.y + fontSize / 2,\n      width,\n      height\n    )\n    firstPage.drawText(item.template(item.value), {\n      x: position.x,\n      y: height - position.y,\n      rotate: degrees(angle),\n      size: fontSize,\n      font,\n      color: rgb(0, 0, 1)\n    })\n  })\n  const modifiedData = await pdfDoc.save()\n\n  const blob = new Blob([modifiedData], { type: 'application/pdf' })\n  console.log('request to download file accepted', blob)\n  saveAs(blob, 'output.pdf')\n}\n\nasync function rotate(fileData, setFileData, angle) {\n  const pdfDoc = await PDFDocument.load(fileData)\n  const [firstPage] = pdfDoc.getPages()\n  const currAngle = firstPage.getRotation().angle\n  firstPage.setRotation(degrees(currAngle + angle))\n  const modifiedData = await pdfDoc.save()\n  setFileData(modifiedData)\n}\n\nfunction ToolbarController({ children }) {\n  const { data: fileData, isFileLoaded, setData: setFileData } = useContext(\n    FileContext\n  )\n  const { scale, setScale, fontSize, setFontSize } = useContext(ViewportContext)\n  const { counter, resetCounter } = useContext(CounterContext)\n  const { modList, resetModList } = useContext(ModificationContext)\n  const onZoomChange = amount => setScale(scale => scale + amount)\n\n  return children({\n    disabled: isFileLoaded() === false,\n    scale,\n    onZoomChange,\n    onRotate: angle => {\n      if (modList.length !== 0) {\n        const result = window.confirm('Warning: all changes will be lost') // TODO: replace this with a proper modal\n        if (result === false) {\n          return // cancel rotation\n        }\n      }\n      rotate(fileData, setFileData, angle)\n      resetModList()\n      resetCounter()\n    },\n    counter,\n    onDownload: () => download(fileData, modList, fontSize),\n    fontSize,\n    setFontSize\n  })\n}\n\nexport default ToolbarController\n","import React from 'react'\n\nimport styles from './Toolbar.module.css'\n\nfunction toolbar({\n  disabled,\n  scale,\n  counter,\n  onZoomChange,\n  onRotate,\n  onDownload,\n  onLoad,\n  fontSize,\n  setFontSize\n}) {\n  const runningLabelText = disabled ? null : (\n    <div className={styles.text}>\n      Place next running label: {`{${counter}}`}\n    </div>\n  )\n\n  const onFontSizeChange = event => {\n    const input = event.target.value\n    const isValidFormat = /^\\d+(\\.\\d)?$/.test(input)\n\n    if (event.target.validity.valid && isValidFormat) {\n      const value = parseFloat(input)\n      const roundByHalf = value => Math.round(value * 2) / 2\n      setFontSize(roundByHalf(value))\n    }\n  }\n\n  return (\n    <div className={styles.toolbar}>\n      <div className={styles.group}>\n        <button disabled={disabled} onClick={() => onZoomChange(+0.1)}>\n          +\n        </button>\n        <button disabled={disabled} onClick={() => onZoomChange(-0.1)}>\n          -\n        </button>\n        <input type=\"text\" disabled value={`${(scale * 100).toFixed(0)}%`} />\n      </div>\n      <div className={styles.group}>\n        <button disabled={disabled} onClick={() => onRotate(-90)}>\n          Left\n        </button>\n        <label>Rotate</label>\n        <button disabled={disabled} onClick={() => onRotate(+90)}>\n          Right\n        </button>\n      </div>\n      <div className={styles.group}>\n        <input\n          type=\"number\"\n          title=\"Font size\"\n          value={fontSize}\n          onChange={onFontSizeChange}\n          disabled={disabled}\n          min=\"1\"\n          max=\"400\"\n          step=\"any\"\n        />\n      </div>\n\n      <button disabled={disabled} onClick={onLoad}>\n        Load\n      </button>\n      <button disabled={disabled} onClick={onDownload}>\n        Download\n      </button>\n      {runningLabelText}\n    </div>\n  )\n}\n\nexport default toolbar\n","import React, { useState, useContext } from 'react'\n\nimport { FileContext } from '../../context/file-context'\nimport { ViewportContext } from '../../context/viewport-context'\nimport { CounterContext } from '../../context/counter-context'\nimport { ModificationContext } from '../../context/modification-context'\n\nfunction LoadDialogController({ children }) {\n  const [showDialog, setShowDialog] = useState(true)\n  const { isFileLoaded, setData: setFileData } = useContext(FileContext)\n  const { resetScale } = useContext(ViewportContext)\n  const { resetCounter } = useContext(CounterContext)\n  const { resetModList } = useContext(ModificationContext)\n\n  const onLoad = data => {\n    setShowDialog(false)\n    setFileData(data)\n    resetScale()\n    resetCounter()\n    resetModList()\n  }\n\n  return children({\n    showDialog,\n    openDialog: () => setShowDialog(true),\n    closeDialog: () => setShowDialog(false),\n    onLoad,\n    isAtReload: () => isFileLoaded() && showDialog\n  })\n}\n\nexport default LoadDialogController\n","import React, { Component } from 'react'\nimport Files from 'react-files'\n\nimport styles from './PdfLoader.module.css'\n\nclass PdfLoader extends Component {\n  onFilesChange = async files => {\n    console.log('got request to load files:', files)\n    const file = files[0]\n    const data = await file.arrayBuffer()\n    console.log('data:', data)\n    this.props.onLoad(data)\n  }\n\n  onFilesError = (error, files) => {\n    console.warn(`error loading files ${files}. error:`, error)\n  }\n\n  render() {\n    return (\n      <div className={styles.dropzone}>\n        <Files\n          className={styles.inner}\n          onChange={this.onFilesChange}\n          onError={this.onFilesError}\n          accepts={['.pdf']}\n          clickable\n          maxFiles={1}\n        >\n          Drop a file here or click to upload\n        </Files>\n      </div>\n    )\n  }\n}\n\nexport default PdfLoader\n","import React, { Component } from 'react'\nimport pdfjs from '@bundled-es-modules/pdfjs-dist/build/pdf'\n\nfunction loadDocument(data) {\n  return pdfjs.getDocument(data).promise\n}\n\nclass PdfDoc extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      docObj: null,\n      data: props.data\n    }\n  }\n\n  async componentDidMount() {\n    const docObj = await loadDocument(this.props.data)\n    this.setState({\n      docObj\n    })\n  }\n\n  async componentDidUpdate(prevProps, prevState) {\n    // will update state only when 'props.data' changes\n    if (this.props.data !== prevProps.data) {\n      console.log('[PdfDoc] updating doc object')\n\n      const docObj = await loadDocument(this.props.data)\n      this.setState({\n        docObj,\n        data: this.props.data\n      })\n    }\n  }\n\n  render() {\n    const { children } = this.props\n    return this.state.docObj !== null ? children(this.state.docObj) : null\n  }\n}\n\nexport default PdfDoc\n","import React, { Component } from 'react'\n\nfunction loadPage(doc, pageNum) {\n  return doc.getPage(pageNum)\n}\n\nclass PdfPage extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      pageObj: null\n    }\n  }\n\n  async componentDidMount() {\n    const { document, pageNum } = this.props\n    const pageObj = await loadPage(document, pageNum)\n    this.setState({\n      pageObj\n    })\n  }\n\n  async componentDidUpdate(prevProps, prevState) {\n    const { document, pageNum } = this.props\n    // will update state only when one of the props changes\n    if (document !== prevProps.document || pageNum !== prevProps.pageNum) {\n      const pageObj = await loadPage(document, pageNum)\n      this.setState({\n        pageObj\n      })\n    }\n  }\n\n  render() {\n    const { children } = this.props\n    return this.state.pageObj !== null ? children(this.state.pageObj) : null\n  }\n}\n\nexport default PdfPage\n","import React, { Component } from 'react'\n\nfunction renderPdfToCanvas(canvasEl, page, scale) {\n  const viewport = page.getViewport({ scale })\n\n  canvasEl.width = viewport.width // canvas width and height must be according to viewport scale!\n  canvasEl.height = viewport.height\n\n  // console.warn('[PdfCanvas] page.render')\n  page.render({\n    canvasContext: canvasEl.getContext('2d'),\n    viewport\n  })\n}\n\nclass PdfCanvas extends Component {\n  constructor(props) {\n    super(props)\n    this.canvasRef = React.createRef()\n  }\n\n  componentDidMount() {\n    const { page, scale } = this.props\n    renderPdfToCanvas(this.canvasRef.current, page, scale)\n  }\n\n  componentDidUpdate(prevProps) {\n    const { page, scale } = this.props\n    if (page !== prevProps.page || scale !== prevProps.scale) {\n      renderPdfToCanvas(this.canvasRef.current, page, scale)\n    }\n  }\n\n  // drawDot = event => {\n  //   const { x, y } = this.getMousePos(event.clientX, event.clientY)\n  //   const canvas = this.canvasRef.current\n  //   const ctx = canvas.getContext('2d')\n  //   ctx.fillRect(x, y, 2, 2)\n  // }\n\n  getMousePos = (x, y) => {\n    // get mouse position relative to canvas\n    const canvas = this.canvasRef.current\n    const { left, top } = canvas.getBoundingClientRect()\n    return {\n      x: x - left,\n      y: y - top\n    }\n  }\n\n  render() {\n    const { onClick } = this.props\n\n    return (\n      <canvas\n        ref={this.canvasRef}\n        onClick={event =>\n          onClick(event, this.getMousePos(event.clientX, event.clientY))\n        }\n        style={{ cursor: 'crosshair' }}\n      />\n    )\n  }\n}\n\nexport default PdfCanvas\n","import React from 'react'\n\nimport styles from './Overlay.module.css'\n\nfunction OverlayItem({\n  position,\n  size,\n  value,\n  scale,\n  template,\n  isSelected,\n  ...otherProps\n}) {\n  return (\n    <div\n      className={`${styles.item} ${isSelected ? styles.selected : ''}`}\n      style={{\n        left: `${(position.x - size / 2) * scale}px`,\n        top: `${(position.y - size / 2) * scale}px`,\n        fontSize: `${size * scale}px`\n      }}\n      draggable={isSelected}\n      title={isSelected ? 'Press <Delete> to remove this' : null}\n      {...otherProps}\n    >\n      {template(value)}\n    </div>\n  )\n}\n\nexport default React.memo(OverlayItem)\n","import React, { useRef, useState, useEffect } from 'react'\nimport KeyboardEventHandler from 'react-keyboard-event-handler'\n\nimport OverlayItem from './OverlayItem'\n\nimport styles from './Overlay.module.css'\n\nfunction getRelativeMousePos(element, event) {\n  const { left, top } = element.getBoundingClientRect()\n  return {\n    x: event.clientX - left,\n    y: event.clientY - top\n  }\n}\n\nfunction Overlay({ items, scale, onItemMove, onItemDelete, fontSize }) {\n  const overlayRef = useRef(null)\n  const [selectedItemId, setSelectedItemId] = useState(null)\n\n  useEffect(() => {\n    if (items.length === 0) {\n      setSelectedItemId(null)\n    }\n  }, [items])\n\n  return (\n    <div\n      ref={overlayRef}\n      className={styles.overlay}\n      style={{\n        position: selectedItemId !== null ? 'absolute' : null\n      }}\n      onClick={() => {\n        setSelectedItemId(null)\n      }}\n    >\n      <KeyboardEventHandler\n        handleKeys={['delete']}\n        handleEventType=\"keyup\"\n        onKeyEvent={() => {\n          if (selectedItemId !== null) {\n            onItemDelete(selectedItemId)\n            setSelectedItemId(null)\n          }\n        }}\n      />\n      {items.map(item => (\n        <OverlayItem\n          key={item.id}\n          position={item.position}\n          size={fontSize}\n          value={item.value}\n          scale={scale}\n          template={item.template}\n          onDragEnd={event =>\n            onItemMove(\n              event,\n              getRelativeMousePos(overlayRef.current, event),\n              item.id\n            )\n          }\n          isSelected={item.id === selectedItemId}\n          onClick={event => {\n            setSelectedItemId(item.id)\n            event.stopPropagation()\n          }}\n        />\n      ))}\n    </div>\n  )\n}\n\nexport default Overlay\n","import React from 'react'\nimport PdfDoc from './PdfDoc'\nimport PdfPage from './PdfPage'\nimport PdfCanvas from './PdfCanvas'\nimport Overlay from './Overlay/Overlay'\n\nimport styles from './PdfViewport.module.css'\n\nfunction PdfViewport({\n  data,\n  pageNum,\n  scale,\n  overlayItems,\n  className = '',\n  style,\n  onClick,\n  onItemMove,\n  onItemDelete,\n  fontSize\n}) {\n  return (\n    <div className={`${className} ${styles.viewport}`} style={style}>\n      <div className={styles.page}>\n        {data !== null ? (\n          <PdfDoc data={data}>\n            {doc => (\n              <PdfPage document={doc} pageNum={pageNum}>\n                {page => (\n                  <React.Fragment>\n                    <Overlay\n                      items={overlayItems}\n                      scale={scale}\n                      onItemMove={onItemMove}\n                      onItemDelete={onItemDelete}\n                      fontSize={fontSize}\n                    />\n                    <PdfCanvas page={page} scale={scale} onClick={onClick} />\n                  </React.Fragment>\n                )}\n              </PdfPage>\n            )}\n          </PdfDoc>\n        ) : null}\n      </div>\n    </div>\n  )\n}\n\nexport default PdfViewport\n","import { useContext } from 'react'\n\nimport { FileContext } from '../../context/file-context'\nimport { ViewportContext } from '../../context/viewport-context'\nimport { CounterContext } from '../../context/counter-context'\nimport { ModificationContext } from '../../context/modification-context'\n\nfunction placeRunningCounter(\n  scale,\n  counter,\n  position,\n  addModification,\n  incrementCounter\n) {\n  const template = value => `(${value})`\n  addModification({\n    position: {\n      x: position.x / scale,\n      y: position.y / scale\n    },\n    value: counter,\n    template\n  })\n  incrementCounter()\n}\n\nfunction PdfViewportController({ children }) {\n  const { data } = useContext(FileContext)\n  const { scale, fontSize } = useContext(ViewportContext)\n  const { counter, incrementCounter, decrementCounter } = useContext(\n    CounterContext\n  )\n  const { modList, addMod: addModification, changeMod, removeMod } = useContext(\n    ModificationContext\n  )\n\n  return children({\n    data,\n    pageNum: 1,\n    scale,\n    overlayItems: modList,\n    onClick: (event, position) =>\n      placeRunningCounter(\n        scale,\n        counter,\n        position,\n        addModification,\n        incrementCounter\n      ),\n    onItemMove: (event, position, id) => {\n      changeMod(id, mod => ({\n        ...mod,\n        position: {\n          x: position.x / scale,\n          y: position.y / scale\n        }\n      }))\n    },\n    onItemDelete: id => {\n      removeMod(id)\n      decrementCounter()\n    },\n    fontSize\n  })\n}\n\nexport default PdfViewportController\n","import { Component } from 'react'\n\nclass EscKeyHandler extends Component {\n  componentDidMount() {\n    document.addEventListener('keyup', this.onKeyup, false)\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keyup', this.onKeyup, false)\n  }\n\n  onKeyup = event => {\n    if (['Escape', 'Esc'].includes(event.key)) {\n      this.props.onClick()\n    }\n  }\n\n  render() {\n    return null\n  }\n}\n\nexport default EscKeyHandler\n","import React from 'react'\n\nimport ViewportStateProvider from '../../context/viewport-context'\nimport CounterProvider from '../../context/counter-context'\nimport ToolbarController from '../../containers/ToobarController/ToobarController'\nimport Toolbar from '../Toolbar/Toolbar'\nimport LoadDialogController from '../../containers/LoadDialogController/LoadDialogController'\nimport PdfLoader from '../PdfLoader/PdfLoader'\nimport PdfViewport from '../PdfRenderer/PdfViewport'\nimport PdfViewportController from '../../containers/PdfViewportController/PdfViewportController'\nimport EscKeyHandler from '../EscKeyHandler/EscKeyHandler'\nimport ModificationProvider from '../../context/modification-context'\n\nimport styles from './PdfEditor.module.css'\n\nfunction PdfEditor() {\n  console.log('[PdfEditor] render')\n\n  return (\n    <div className={styles.screenViewport}>\n      <ViewportStateProvider>\n        <CounterProvider>\n          <ModificationProvider>\n            <div className={styles.editorArea}>\n              <LoadDialogController>\n                {loadDialogCtrl => (\n                  <React.Fragment>\n                    {loadDialogCtrl.isAtReload() ? (\n                      <EscKeyHandler onClick={loadDialogCtrl.closeDialog} />\n                    ) : null}\n\n                    <ToolbarController>\n                      {toolbarCtrl => (\n                        <Toolbar\n                          onLoad={loadDialogCtrl.openDialog}\n                          {...toolbarCtrl}\n                        />\n                      )}\n                    </ToolbarController>\n                    <div className={styles.pdfViewportArea}>\n                      {loadDialogCtrl.showDialog ? (\n                        <PdfLoader onLoad={loadDialogCtrl.onLoad} />\n                      ) : null}\n\n                      <PdfViewportController>\n                        {viewportCtrl => <PdfViewport {...viewportCtrl} />}\n                      </PdfViewportController>\n                    </div>\n                  </React.Fragment>\n                )}\n              </LoadDialogController>\n            </div>\n          </ModificationProvider>\n        </CounterProvider>\n      </ViewportStateProvider>\n    </div>\n  )\n}\n\nexport default PdfEditor\n","import React from 'react'\nimport './App.css'\n\nimport FileProvider from '../context/file-context'\nimport PdfEditor from '../components/PdfEditor/PdfEditor'\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <FileProvider>\n        <PdfEditor />\n      </FileProvider>\n    </div>\n  )\n}\n\nexport default App\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n)\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href)\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config)\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          )\n        })\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config)\n      }\n    })\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing\n        if (installingWorker == null) {\n          return\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              )\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration)\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.')\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration)\n              }\n            }\n          }\n        }\n      }\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error)\n    })\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type')\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload()\n          })\n        })\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config)\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      )\n    })\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister()\n    })\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './containers/App'\nimport * as serviceWorker from './serviceWorker'\nimport pdfjs from '@bundled-es-modules/pdfjs-dist/build/pdf'\n\npdfjs.GlobalWorkerOptions.workerSrc =\n  'https://cdn.jsdelivr.net/npm/pdfjs-dist@2.1.266/build/pdf.worker.min.js' // TODO: replace cdn with package worker\n// '@bundled-es-modules/pdfjs-dist/build/pdf.worker.min.js'\n\nReactDOM.render(<App />, document.getElementById('root'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister()\n"],"sourceRoot":""}